<!-- Modern Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container-fluid pl-3">
    <!-- Logo -->
    <a class="navbar-brand d-flex align-items-center" href="<%= root_path %>">

      <span class="brand-text text-primary " style = "font-size: 19.5pt;">Fotobook</span>
    </a>

    <!-- Search Form -->
    <div class="search-container mx-auto d-none d-lg-block" style="max-width: 720px;">
      <form class="d-flex position-relative">
        <div class="input-group shadow-sm">
          <span class="input-group-text bg-white border-end-0" style="border-radius: 10px 0 0 10px; border: 1px solid #e1e5e9;">
            <i class="fas fa-search text-muted" style="font-size: 1rem;"></i>
          </span>
          <input class="form-control border-start-0" 
                 type="search" 
                 placeholder="Search photos, albums, or people..." 
                 aria-label="Search"
                 style="border-radius: 0 10px 10px 0; height: 40px ">
        </div>
      </form>
    </div>

    <!-- Right Navigation -->
    <div class="navbar-nav ms-auto align-items-center">
      <% if user_signed_in? %>
        <% unless current_user.admin? %>
          <!-- Navigation Links for Regular Users -->
          <div class="nav-item me-3 d-none d-lg-block">
            <a class="nav-link d-flex align-items-center " href="<%= feeds_path %>">
              <i class="custom-icons fas fa-home me-1 text-primary"></i>
              <span class = "d-none d-lg-inline   text-primary" style = "font-size: 11pt; font-weight: bold">Feeds</span>
            </a>
          </div>
          
          <div class="nav-item me-3 d-none d-lg-block">
            <a class="nav-link d-flex align-items-center" href="<%= discovery_path %>">
              <i class="custom-icons fas fa-compass me-1 text-primary"></i>
              <span class = "d-none d-lg-inline   text-primary" style = "font-size: 11pt; font-weight: bold">Discover</span>
            </a>
          </div>



          <!-- Quick Actions for Regular Users -->
          <div class="nav-item me-3">
            <a class="nav-link btn btn-sm text-dark" href="<%= new_photo_path %>" title="Add Photo">
              <i class="custom-icons fas fa-plus me-1 text-primary"></i>
              <span class="d-none d-lg-inline  text-primary" style = "font-weight: bold">Photo</span>
            </a>
          </div>

          <div class="nav-item me-3">
            <a class="nav-link btn btn-sm text-dark" href="<%= new_album_path %>" title="Create Album">
              <i class="custom-icons fas fa-images me-1 text-primary"></i>
              <span class="d-none d-lg-inline text-primary" style = "font-weight: bold">Album</span>
            </a>
          </div>
        <% end %>

        <!-- User Menu -->
        <div class="dropdown">
          <button class="bg-transparent btn btn-link nav-link dropdown-toggle d-flex align-items-center text-white text-decoration-none" 
                  type="button" 
                  onclick="toggleDropdown()"
                  style="border-radius: 15px; padding: 0.4rem 0rem;">
            <div class="user-avatar me-1">
              <% if current_user.avatar.present? %>
                <%= image_tag current_user.avatar.url, 
                    class: 'rounded-circle', 
                    width: 35, 
                    height: 35,
                    style: 'object-fit: cover;' %>
              <% else %>
                <div class="avatar-placeholder rounded-circle d-flex align-items-center justify-content-center"
                     style="width: 25px; height: 25px; background: rgba(255,255,255,0.2);">
                  <i class="fas fa-user text-primary"></i>
                </div>
              <% end %>
            </div>
            <span class="user-name d-none d-lg-inline text-dark"><%= current_user.first_name %></span>
          </button>
          
          <ul class="dropdown-menu dropdown-menu-end" id="dropdownMenu" style="display: none; min-width: 250px;">
            <li class="dropdown-header">
              <div class="d-flex align-items-center">
                <div class="user-avatar me-3">
                  <% if current_user.avatar.present? %>
                    <%= image_tag current_user.avatar.url, 
                        class: 'rounded-circle', 
                        width: 40, 
                        height: 40,
                        style: 'object-fit: cover;' %>
                  <% else %>
                    <div class="avatar-placeholder rounded-circle d-flex align-items-center justify-content-center"
                         style="width: 44px; height: 44px; background: var(--primary-color);">
                      <i class="fas fa-user text-white"></i>
                    </div>
                  <% end %>
                </div>
                <div>
                  <div class="fw-bold"><%= current_user.first_name %> <%= current_user.last_name %></div>
                  <small class="text-muted"><%= current_user.email %></small>
                </div>
              </div>
            </li>
            
            <li><hr class="dropdown-divider"></li>
            
            <% unless current_user.admin? %>
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= profile_path %>">
                  <i class="fas fa-user me-3 text-primary"></i>
                  <div>
                    <div class="fw-medium">My Profile</div>
                    <small class="text-muted">View your profile</small>
                  </div>
                </a>
              </li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= edit_profile_path %>">
                  <i class="fas fa-edit me-3 text-warning"></i>
                  <div>
                    <div class="fw-medium">Edit Profile</div>
                    <small class="text-muted">Update your information</small>
                  </div>
                </a>
              </li>
              
              <li><hr class="dropdown-divider"></li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= new_photo_path %>">
                  <i class="fas fa-plus me-3 text-success"></i>
                  <div>
                    <div class="fw-medium">Add Photo</div>
                    <small class="text-muted">Upload a new photo</small>
                  </div>
                </a>
              </li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= new_album_path %>">
                  <i class="fas fa-images me-3 text-info"></i>
                  <div>
                    <div class="fw-medium">Create Album</div>
                    <small class="text-muted">Create a new album</small>
                  </div>
                </a>
              </li>
            <% end %>
            
            <% if current_user.admin? %>
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= admin_dashboard_path %>">
                  <i class="fas fa-tachometer-alt me-3 text-primary"></i>
                  <div>
                    <div class="fw-medium">Dashboard</div>
                    <small class="text-muted">Admin overview</small>
                  </div>
                </a>
              </li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= admin_users_path %>">
                  <i class="fas fa-users me-3 text-info"></i>
                  <div>
                    <div class="fw-medium">Manage Users</div>
                    <small class="text-muted">User management</small>
                  </div>
                </a>
              </li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= admin_albums_path %>">
                  <i class="fas fa-images me-3 text-success"></i>
                  <div>
                    <div class="fw-medium">Manage Albums</div>
                    <small class="text-muted">Album management</small>
                  </div>
                </a>
              </li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= admin_photos_path %>">
                  <i class="fas fa-camera me-3 text-warning"></i>
                  <div>
                    <div class="fw-medium">Manage Photos</div>
                    <small class="text-muted">Photo management</small>
                  </div>
                </a>
              </li>
              
              <li><hr class="dropdown-divider"></li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="<%= feeds_path %>">
                  <i class="fas fa-home me-3 text-secondary"></i>
                  <div>
                    <div class="fw-medium">View Site</div>
                    <small class="text-muted">Go to public site</small>
                  </div>
                </a>
              </li>
            <% end %>
            
            <li><hr class="dropdown-divider"></li>
            
            <li>
              <%= form_tag destroy_user_session_path, method: :delete, style: 'margin: 0; padding: 0;' do %>
                <%= submit_tag 'Logout', type: 'submit', class: 'dropdown-item d-flex align-items-center text-danger border-0 bg-transparent w-100 text-start logout-btn', 
                    style: 'background: none; border: none; text-align: left; padding: 0.5rem 1rem;',
                    data: { confirm: 'Bạn có chắc chắn muốn đăng xuất?' } %>
                <div class="position-absolute" style="pointer-events: none; left: 1rem; top: 50%; transform: translateY(-50%);">

                </div>
              <% end %>
            </li>
          </ul>
        </div>


      <% else %>
        <!-- Guest Navigation -->
        <div class="nav-item me-2">
          <a href="<%= new_user_session_path %>" class="btn btn-sm text-dark">
            <i class="fas fa-sign-in-alt me-1"></i>Login
          </a>
        </div>
        <div class="nav-item">
          <a href="<%= new_user_registration_path %>" class="btn btn-sm text-dark">
            <i class="fas fa-user-plus me-1"></i>Sign Up
          </a>
        </div>
      <% end %>
    </div>
  </div>
</nav>

<!-- Mobile Search Bar -->
<% if user_signed_in? && !current_user.admin? %>
  <div class="d-lg-none bg-white border-bottom">
    <div class="container-fluid px-4 py-2">
      <form class="d-flex">
        <div class="input-group">
          <span class="input-group-text bg-light border-end-0">
            <i class="fas fa-search text-muted"></i>
          </span>
          <input class="form-control border-start-0" 
                 type="search" 
                 placeholder="Search..." 
                 aria-label="Search"
                 style="border-radius: 0 25px 25px 0;">
        </div>
      </form>
    </div>
  </div>
<% end %> 