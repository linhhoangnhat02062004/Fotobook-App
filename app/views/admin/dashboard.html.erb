<% content_for :title, "Dashboard" %>
<% content_for :layout, "admin" %>

<div class="row">
  <div class="col-12">
    <h1 class="mb-4">Admin Dashboard</h1>
  </div>
</div>

<!-- Stats Cards -->
<div class="row mb-4">
  <div class="col-md-3">
    <div class="stats-card">
      <div class="d-flex align-items-center">
        <div class="me-3">
          <i class="fas fa-users fa-2x"></i>
        </div>
        <div>
          <h3><%= @total_users %></h3>
          <p>Total Users</p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="stats-card">
      <div class="d-flex align-items-center">
        <div class="me-3">
          <i class="fas fa-images fa-2x"></i>
        </div>
        <div>
          <h3><%= @total_albums %></h3>
          <p>Total Albums</p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="stats-card">
      <div class="d-flex align-items-center">
        <div class="me-3">
          <i class="fas fa-camera fa-2x"></i>
        </div>
        <div>
          <h3><%= @total_photos %></h3>
          <p>Total Photos</p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="stats-card">
      <div class="d-flex align-items-center">
        <div class="me-3">
          <i class="fas fa-chart-line fa-2x"></i>
        </div>
        <div>
          <h3><%= @total_photos + @total_albums %></h3>
          <p>Total Content</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Recent Activities -->
<div class="row">
  <!-- Recent Users -->
  <div class="col-md-4">
    <div class="admin-card">
      <div class="admin-card-header">
        <h5 class="admin-card-title">
          <i class="fas fa-users me-2"></i>Recent Users
        </h5>
      </div>
      <div class="admin-card-body">
        <% if @recent_users.any? %>
          <% @recent_users.each do |user| %>
            <div class="d-flex align-items-center mb-3">
              <div class="me-3">
                <% if user.avatar.present? %>
                  <%= image_tag user.avatar.url, class: 'rounded-circle', width: 40, height: 40 %>
                <% else %>
                  <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center text-white" style="width: 40px; height: 40px;">
                    <%= user.first_name.first.upcase %><%= user.last_name.first.upcase %>
                  </div>
                <% end %>
              </div>
              <div class="flex-grow-1">
                <div class="fw-medium"><%= user.full_name %></div>
                <small class="text-muted"><%= user.email %></small>
              </div>
              <div>
                <span class="badge <%= user.status_badge_class %>"><%= user.status_text %></span>
              </div>
            </div>
          <% end %>
          <div class="text-center">
            <%= link_to 'View All Users', admin_users_path, class: 'btn btn-primary btn-sm' %>
          </div>
        <% else %>
          <p class="text-muted text-center">No users yet</p>
        <% end %>
      </div>
    </div>
  </div>
  
  <!-- Recent Albums -->
  <div class="col-md-4">
    <div class="admin-card">
      <div class="admin-card-header">
        <h5 class="admin-card-title">
          <i class="fas fa-images me-2"></i>Recent Albums
        </h5>
      </div>
      <div class="admin-card-body">
        <% if @recent_albums.any? %>
          <% @recent_albums.each do |album| %>
            <div class="d-flex align-items-center mb-3">
              <div class="me-3">
                <% if album.cover_photo&.image.present? %>
                  <%= image_tag album.cover_photo.image.url, class: 'rounded', width: 40, height: 40, style: 'object-fit: cover;' %>
                <% else %>
                  <div class="bg-light rounded d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                    <i class="fas fa-images text-muted"></i>
                  </div>
                <% end %>
              </div>
              <div class="flex-grow-1">
                <div class="fw-medium"><%= album.title %></div>
                <small class="text-muted">by <%= album.user.full_name %></small>
              </div>
              <div>
                <span class="badge <%= album.sharing_mode == 'private' ? 'badge-warning' : 'badge-success' %>">
                  <%= album.sharing_mode.titleize %>
                </span>
              </div>
            </div>
          <% end %>
          <div class="text-center">
            <%= link_to 'View All Albums', admin_albums_path, class: 'btn btn-primary btn-sm' %>
          </div>
        <% else %>
          <p class="text-muted text-center">No albums yet</p>
        <% end %>
      </div>
    </div>
  </div>
  
  <!-- Recent Photos -->
  <div class="col-md-4">
    <div class="admin-card">
      <div class="admin-card-header">
        <h5 class="admin-card-title">
          <i class="fas fa-camera me-2"></i>Recent Photos
        </h5>
      </div>
      <div class="admin-card-body">
        <% if @recent_photos.any? %>
          <% @recent_photos.each do |photo| %>
            <div class="d-flex align-items-center mb-3">
              <div class="me-3">
                <% if photo.image.present? %>
                  <%= image_tag photo.image.url, class: 'rounded', width: 40, height: 40, style: 'object-fit: cover;' %>
                <% else %>
                  <div class="bg-light rounded d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                    <i class="fas fa-camera text-muted"></i>
                  </div>
                <% end %>
              </div>
              <div class="flex-grow-1">
                <div class="fw-medium"><%= photo.title %></div>
                <small class="text-muted">by <%= photo.user.full_name %></small>
              </div>
              <div>
                <span class="badge <%= photo.sharing_mode == 'private' ? 'badge-warning' : 'badge-success' %>">
                  <%= photo.sharing_mode.titleize %>
                </span>
              </div>
            </div>
          <% end %>
          <div class="text-center">
            <%= link_to 'View All Photos', admin_photos_path, class: 'btn btn-primary btn-sm' %>
          </div>
        <% else %>
          <p class="text-muted text-center">No photos yet</p>
        <% end %>
      </div>
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div class="row mt-4">
  <div class="col-12">
    <div class="admin-card">
      <div class="admin-card-header">
        <h5 class="admin-card-title">
          <i class="fas fa-bolt me-2"></i>Quick Actions
        </h5>
      </div>
      <div class="admin-card-body">
        <div class="row">
          <div class="col-md-3">
            <%= link_to admin_users_path, class: 'btn btn-outline-primary w-100 mb-2' do %>
              <i class="fas fa-users me-2"></i>Manage Users
            <% end %>
          </div>
         <div class="col-md-3">
            <%= link_to admin_albums_path, class: 'btn btn-outline-primary w-100 mb-2' do %>
              <i class="fas fa-images me-2"></i>Manage Albums
            <% end %>
          </div>
          <div class="col-md-3">
            <%= link_to admin_photos_path, class: 'btn btn-outline-primary w-100 mb-2' do %>
              <i class="fas fa-camera me-2"></i>Manage Photos
            <% end %>
          </div>
          <div class="col-md-3">
            <%= link_to feeds_path, class: 'btn btn-outline-secondary w-100 mb-2' do %>
              <i class="fas fa-home me-2"></i>View Site
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 